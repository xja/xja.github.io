# WizTree V4.08 Python KeyGen


此代码是根据网上的 keygen.exe 文件反编译转换而来的。因为原 exe 也仅有 3KB 大小，就尝试着拿来研究了一下，结果还是花了两三天才完成。

## 简要说明

1. WizTree 所有功能针对个人都是免费的，商用请联系官方购买正版
2. 激活码**仅移除捐赠按钮和捐赠消息**，具体区别见官方说明
3. 此代码和原 exe 均有可能会生成过期无效的激活码，生成 100% 有效的激活码不在本文的研究范围
4. 使用激活码需要断网或阻止应用程序联网，否则会激活失败
5. 使用 [Python在线运行工具](http://dh.ci/wiztreekeygen)([原链接](https://www.online-python.com/Sfd0laEQCD)) 可以直接在线生成激活码，无需 Python 环境

## Python 代码

```python
from random import randint


rn = [randint(0, 255) for _ in range(14)]
rn[1] = 0xE7
rn[5] = 0x03

arg2 = [0xc, 6]
arg3 = [3, 0xf3]
for i in range(2):
    a1 = 0
    for j in range(4):
        a1 <<= 8
        a1 += rn[i * 4 + j]
    rn[9+3*i] = ((a1 >> arg2[i]) & 0xff) ^ ((a1 & 0xff) | arg3[i])

rs = ''
for i in range(14):
    rs += f'{rn[i]:02X}'
    if i % 2:
        rs += '-'

cx = 0x42
dx = 0xBE
for s in rs:
    if s != '-':
        dx += ord(s)
        if dx > 0xFF:
            dx -= 0xFF
        cx += dx
        if cx > 0xFF:
            cx -= 0xFF

rs += f'{cx:02X}{dx:02X}'
print(rs)
```

## KeyGen.exe Base64

```text
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
```

